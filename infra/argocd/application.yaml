---
# Argo CD Application for User Service
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: userservice
spec:
  source:
    repoURL: 'https://github.com/arun-0/microservices-app.git'
    path: infra/helm/userservice
    targetRevision: HEAD
  destination:
    server: https://kubernetes.default.svc
    namespace: default
  project: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: true

---
# Argo CD Application for Orders Service
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: orderservice
spec:
  source:
    repoURL: 'https://github.com/arun-0/microservices-app.git'
    path: infra/helm/orderservice
    targetRevision: HEAD
  destination:
    server: https://kubernetes.default.svc
    namespace: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: true

---
# Argo CD Application for Kafka Producer
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: kafkaproducer
spec:
  source:
    repoURL: 'https://github.com/arun-0/microservices-app.git'
    path: infra/helm/kafkaproducer
    targetRevision: HEAD
    helm:       # helm: This section allows you to pass parameters to your Helm chart during the deployment. will only have an effect if your Helm chart is designed to use those variables.
      parameters:
        - name: image.repository
          value: your-docker-repo/kafkaproducer
        - name: image.tag
          value: latest  # Update if you're using a specific tag
    credentials:
      - name: argocd-github-creds
  destination:
    server: https://kubernetes.default.svc
    namespace: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
